# 跨平台编译

自2.0版本开始，mpx开始支持跨小程序平台编译，不同于常规跨平台框架重新定义一套自己的DSL进行编码的做法，mpx支持基于现有的平台源码编译为其他已支持平台的目标代码，例如，你可以将当前已有的mpx微信小程序项目直接编译为支付宝小程序在支付宝中进行运行。

## 使用方法

为了使用上述跨平台编译特性，你只需要进行简单的配置修改，打开项目的webpack配置，找到@mpxjs/webpack-plugin的声明位置，进行如下配置

```js
// 下面的示例配置能够将mpx微信小程序源码编译为支付宝小程序
new MpxWebpackPlugin({
  // mode为mpx编译的目标平台，可选值有(wx|ali|swan)
  mode: 'ali',
  // srcMode为mpx编译的源码平台，目前仅支持wx   
  srcMode: 'wx' 
})
```

## 跨平台条件编译

mpx跨平台的编译的原则在于，`能转则转，转不了则报错提示`，对于报错的部分，我们提供了完善的跨平台条件编译机制便于用户处理因平台差异而无法相互转换的部分，也能够用于编写平台差异业务逻辑。

mpx中我们支持了三种维度的条件编译，分包是文件维度，区块维度和代码维度。

### 文件维度条件编译
文件维度条件编译简单的来说就是文件为维度进行跨平台差异代码的编写，例如在微信->支付宝的项目中存在一个业务地图组件map.mpx，由于微信和支付宝中的原生地图组件标准差异非常大，无法通过框架转译方式直接进行跨平台输出，这时你可以在相同的位置新建一个map.ali.mpx，在当中使用支付宝的标准编写


## 已支持的跨平台编译

目前mpx已经支持了微信->支付宝的跨平台编译，未来会支持微信->所有已支持平台的跨平台编译输出，同时我们也会将跨平台编译的转换规则开发进行完善的文档说明，便于社区贡献更多的转换规则

## 已支持小程序平台

目前mpx支持微信、支付宝、百度小程序，未来也会继续跟进更多的小程序平台。

不同平台上增强的指令也有所差别，文档和代码示例为了方便统一采用微信小程序下的书写方式。

此处提供一份对应表：

指令|微信|支付宝|百度
----|----|----|----
双向绑定|wx:model|a:model|s-model
双向绑定辅助属性|wx:model-prop|a:model-prop|s-model-prop
双向绑定辅助属性|wx:model-event|a:model-event|s-model-event
动态样式绑定|wx:class|a:class|s-class
动态样式绑定|wx:style|a:style|s-style
获取*ML上node节点|wx:ref|a:ref|s-ref

